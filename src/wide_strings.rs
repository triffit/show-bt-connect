// SPDX-License-Identifier: MIT
//! UTF-16 wide string helpers & common static constants for Windows FFI.
use std::ffi::OsStr;
use std::os::windows::ffi::OsStrExt;

pub fn to_wide(s: &str) -> Vec<u16> { OsStr::new(s).encode_wide().collect() }

pub fn to_wide_null(s: &str) -> Vec<u16> {
    let mut v = to_wide(s);
    v.push(0);
    v
}

// Common static wide strings to avoid repeated allocations.
pub const WIDE_OPEN: &[u16] = &[0x006F, 0x0070, 0x0065, 0x006E, 0]; // "open\0"
pub const WIDE_ABOUT: &[u16] = &[0x0041, 0x0062, 0x006F, 0x0075, 0x0074, 0]; // "About\0"
pub const WIDE_CLASSNAME: &[u16] = &[
    0x0052,0x0065,0x0073,0x0074,0x006F,0x0072,0x0065, // Restore
    0x0057,0x0069,0x006E,0x004B,0x0042,0x0074,0x0048,0x0069,0x0064,0x0064,0x0065,0x006E,0 // WinKBtHidden
];
pub const WIDE_TASKBAR_CREATED: &[u16] = &[
    0x0054,0x0061,0x0073,0x006B,0x0062,0x0061,0x0072,0x0043,0x0072,0x0065,0x0061,0x0074,0x0065,0x0064,0 // TaskbarCreated\0
];

// Global mutex name ("Global\\RestoreWinKBluetoothDevicesPanelMutex\0") as UTF-16.
pub const WIDE_MUTEX_NAME: &[u16] = &[
    0x0047,0x006C,0x006F,0x0062,0x0061,0x006C,0x005C, // Global\
    0x0052,0x0065,0x0073,0x0074,0x006F,0x0072,0x0065, // Restore
    0x0057,0x0069,0x006E,0x004B, // WinK
    0x0042,0x006C,0x0075,0x0065,0x0074,0x006F,0x006F,0x0074,0x0068, // Bluetooth
    0x0044,0x0065,0x0076,0x0069,0x0063,0x0065,0x0073, // Devices
    0x0050,0x0061,0x006E,0x0065,0x006C, // Panel
    0x004D,0x0075,0x0074,0x0065,0x0078, // Mutex
    0x0000
];